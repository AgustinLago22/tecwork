TECWORK - DOCUMENTACI√ìN T√âCNICA
================================

RESUMEN DEL PROYECTO
--------------------
TecWork: Plataforma que conecta estudiantes universitarios (UNNE) con proyectos reales de negocios.
Stack: Next.js 15 + TypeScript + Tailwind CSS + Supabase + Vercel
Fundada: 2025 por estudiantes apasionados por educaci√≥n y tecnolog√≠a

ARQUITECTURA
------------
Frontend: Next.js 15 App Router + shadcn/ui
Backend: API Routes + Vercel Edge Functions
Database: Supabase PostgreSQL con RLS policies
Storage: Supabase Storage (CVs)
Auth: Custom session-based con bcrypt
Deploy: Vercel (tecwork-w526 ‚Üí tecwork.ar)

ESTRUCTURA BASE DE DATOS
-------------------------
Tablas principales (UUID):
- leads: empresas interesadas (nombre, email, telefono, empresa, necesidad, mensaje, fuente, urgencia_id, estado_id, tipo_proyecto_id)
- aplicantes: estudiantes (nombre, apellido, email, telefono, a√±o_cursado, github_url, linkedin_url, portfolio_url, cv_url, habilidades, motivacion, universidad_id, carrera_id, nivel_experiencia_id, estado_id)

Cat√°logos (SERIAL):
- universidades, carreras, niveles_experiencia, estados_leads, estados_aplicantes, niveles_urgencia, tipos_proyecto

Vistas optimizadas:
- vista_leads, vista_aplicantes (JOINs completos)

Auth tables:
- admins, admin_sessions, admin_security_logs

RUTAS PRINCIPALES
-----------------
P√∫blicas:
- / - Home
- /servicios - Servicios ofrecidos
- /about - Nosotros (historia real)
- /contacto - Formulario empresas ‚Üí leads
- /sumate - Formulario estudiantes ‚Üí aplicantes

Admin (protegidas):
- /login - Auth con email/password
- /dashboard - Panel con m√©tricas
- /dashboard/crm - CRM completo (leads + estudiantes)

APIs:
- /api/auth/* - login, logout, verify
- /api/leads - GET (admin), POST (p√∫blico)
- /api/applicants - GET (admin), POST (p√∫blico)
- /api/upload-cv - Upload CVs a Supabase Storage
- /api/leads/update, /api/applicants/update - Actualizar estados

VARIABLES DE ENTORNO REQUERIDAS
--------------------------------
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOi...
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOi...
NEXT_PUBLIC_APP_URL=http://localhost:3000

SCRIPTS SQL (ejecutar en Supabase)
-----------------------------------
1. scripts/create-base.sql - Schema completo
2. scripts/add-cv-field.sql - Campo cv_url
3. scripts/add-fuente-field.sql - Campo fuente en leads
4. scripts/setup-storage.sql - Bucket CVs + RLS
5. scripts/admin-system.sql - Auth system completo

Crear primer admin:
INSERT INTO admins (email, password_hash, nombre, apellido, rol)
VALUES ('email@ejemplo.com', crypt('password', gen_salt('bf')), 'Nombre', 'Apellido', 'super_admin');

SESI√ìN 07/10/2025 - √öLTIMOS CAMBIOS
====================================

‚úÖ SEGURIDAD
- Sistema sanitizaci√≥n: lib/utils/sanitize.ts
  * sanitizeString, sanitizeEmail, sanitizePhone, sanitizeUrl, sanitizeTextArea, validateNumberInRange
- Integrado en /api/leads y /api/applicants
- Protecci√≥n anti-SQL injection, XSS, validaci√≥n de inputs

‚úÖ FIXES CR√çTICOS
- Logout corregido: redirige a "/" (app/api/auth/logout/route.ts)
- /casos removido del navbar
- Master/Doctorado removidos de /sumate (solo 1¬∫-5¬∫ a√±o)
- Bot√≥n /servicios: "Solicitar cotizaci√≥n" ‚Üí "Planifica tu proyecto"

‚úÖ PERFORMANCE - CRM OPTIMIZADO
- Dashboard CRM refactorizado (app/dashboard/crm/page.tsx):
  * Server: solo COUNT queries (estad√≠sticas b√°sicas)
  * Client: lazy loading de datos completos bajo demanda
  * Reducci√≥n 70-80% tiempo carga inicial
- LeadsCRM y StudentsCRM con useEffect + fetch cuando se abre
- Spinners de loading elegantes

‚úÖ CONTENIDO - /ABOUT MEJORADO
- Historia real de estudiantes fundadores
- Propuesta de valor dual clara (estudiantes + negocios)
- Estad√≠sticas realistas para startup:
  * 15+ estudiantes en la red
  * 5+ proyectos en desarrollo
  * UNNE universidad aliada
  * 2025 a√±o de fundaci√≥n
- Misi√≥n/Visi√≥n actualizadas: menos corporativo, m√°s aut√©ntico

ARCHIVOS CLAVE MODIFICADOS
---------------------------
Nuevos:
- lib/utils/sanitize.ts

Modificados:
- app/about/page.tsx, app/sumate/page.tsx, app/servicios/page.tsx
- app/api/leads/route.ts, app/api/applicants/route.ts, app/api/auth/logout/route.ts
- app/dashboard/crm/page.tsx
- components/dashboard/LeadsCRM.tsx, components/dashboard/StudentsCRM.tsx
- components/navigation.tsx

BUILD STATUS
------------
‚úÖ Build exitoso (npm run build)
‚ö†Ô∏è Solo warnings de variables no usadas (no cr√≠tico)
‚úÖ 25 p√°ginas generadas
‚úÖ Compilaci√≥n: ~3-4 segundos

DEPLOY - ESTADO ACTUAL
-----------------------
Producci√≥n: tecwork-w526 (tecwork.ar) - rama main
Preview: develop (pendiente)

ISSUE: 3 proyectos Vercel conectados al mismo repo
- tecwork-w526 ‚úÖ ‚Üí Principal (tecwork.ar) - TIENE ENV VARS
- tecwork-6u73 ‚ùå ‚Üí Duplicado vac√≠o (eliminar)
- tecwork ‚ùå ‚Üí Duplicado vac√≠o (eliminar)

PR√ìXIMOS PASOS
--------------
1. [ ] Eliminar proyectos tecwork-6u73 y tecwork de Vercel
2. [ ] Push develop: git push origin develop
3. [ ] Testing preview: tecwork-w526-git-develop-[user].vercel.app
4. [ ] Merge develop ‚Üí main cuando todo est√© OK
5. [ ] Deploy producci√≥n autom√°tico

COMANDOS √öTILES
---------------
npm run dev - Desarrollo local
npm run build - Build producci√≥n
npm run lint - Linting
git push origin develop - Deploy preview
git push origin main - Deploy producci√≥n

NOTAS IMPORTANTES
-----------------
- Auth: Solo crear admins via SQL directo (API setup DESHABILITADA)
- RLS policies habilitadas en todas las tablas
- CVs en Supabase Storage bucket 'cvs'
- Formularios p√∫blicos con validaciones burbujas conversacionales
- Dashboard/CRM solo admin con autenticaci√≥n
- Middleware protege rutas /dashboard y /admin

√öLTIMA ACTUALIZACI√ìN: 07/10/2025
Estado: üîß DEVELOP LISTO - PENDIENTE LIMPIEZA VERCEL
Rama: develop (commit: feat: mejoras seguridad, UX y contenido)
‚úÖ Seguridad + Performance + Contenido real implementados
